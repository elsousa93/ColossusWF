{
    "className": "org.joget.apps.form.model.Form",
    "elements": [{
        "className": "org.joget.apps.form.model.Section",
        "elements": [{
            "className": "org.joget.apps.form.model.Column",
            "elements": [
                {
                    "className": "org.joget.apps.form.lib.SelectBox",
                    "properties": {
                        "controlField": "",
                        "id": "status",
                        "label": "Estado Agendamento",
                        "multiple": "",
                        "options": [],
                        "optionsBinder": {
                            "className": "org.joget.apps.form.lib.BeanShellFormBinder",
                            "properties": {
                                "cacheInterval": "",
                                "script": "import org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.form.model.Element;\nimport org.joget.apps.form.model.FormData;\nimport org.joget.apps.form.model.FormRow;\nimport org.joget.apps.form.model.FormRowSet;\nimport org.joget.apps.form.model.FormStoreBinder;\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport javax.sql.DataSource;\nimport org.joget.apps.form.service.FormUtil;\nimport org.joget.apps.app.model.AppDefinition;\nimport org.joget.commons.util.LogUtil;\n\n\npublic FormRowSet getStatusAgendamento() {\n    Connection con = null;\n    PreparedStatement stmt = null;\n    ResultSet rs = null;\n    String status = \"\";\n    String statusLabel = \"\";\n    \n    AppDefinition appDef = AppUtil.getCurrentAppDefinition();\n    \n    \n    try{\n            DataSource ds = (DataSource)AppUtil.getApplicationContext().getBean(\"setupDataSource\");\n            con = ds.getConnection();\n            \n            if(!con.isClosed()){\n                \n                String idProcesso = \"#form.processos_procu.id#\";\n                \n                String queryGetLastAto = \"SELECT c_status FROM app_fd_atos_procu WHERE c_id_processo = ? ORDER BY dateCreated DESC LIMIT 1\";\n                stmt = con.prepareStatement(queryGetLastAto);\n                stmt.setObject(1, idProcesso);\n                rs = stmt.executeQuery();\n                if(rs.next()){\n                    status = rs.getObject(\"c_status\");\n                    String queryGetValueLabel = \"SELECT c_label FROM app_fd_listas_de_valores WHERE c_nome_campo = 'estado_agendamento' AND c_value = ? ;\";\n                    stmt = con.prepareStatement(queryGetValueLabel);\n                    stmt.setObject(1, status);\n                    rs = stmt.executeQuery();\n                    if(rs.next()){\n                        statusLabel = rs.getObject(\"c_label\");\n                    }\n                }\n                    \n            }\n            \n    }catch(Exception e){\n        LogUtil.error(appDef.toString(), e, \"Error getting info from DB\");\n    }finally{\n        try{\n            if(rs != null){\n            rs.close();\n            }\n            if(stmt != null){\n                stmt.close();\n            }\n            if(con != null && !con.isClosed()) {\n                con.close();\n            }\n        }catch(Exception e){\n            LogUtil.error(appDef.toString(), e, \"Error closing DB connection\");\n        }\n        \n    }\n    FormRowSet f = new FormRowSet();\n    FormRow r1 = new FormRow();\n    r1.put(FormUtil.PROPERTY_VALUE, status);\n    r1.put(FormUtil.PROPERTY_LABEL, statusLabel);\n    f.add(r1);\n    return f;\n}\n \nreturn getStatusAgendamento();\n        ",
                                "useAjax": ""
                            }
                        },
                        "permissionHidden": "",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "e0225c76-302c-9aba-4b69-9cce67038591": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {
                                "permissionHidden": "",
                                "readonly": ""
                            },
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {
                                "permissionHidden": "",
                                "readonly": ""
                            }
                        },
                        "readonly": "",
                        "readonlyLabel": "",
                        "size": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.SelectBox",
                    "properties": {
                        "controlField": "",
                        "id": "motivo",
                        "label": "Motivo Desmarcação",
                        "multiple": "",
                        "options": [],
                        "optionsBinder": {
                            "className": "org.joget.apps.form.lib.BeanShellFormBinder",
                            "properties": {
                                "cacheInterval": "",
                                "script": "import org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.form.model.Element;\nimport org.joget.apps.form.model.FormData;\nimport org.joget.apps.form.model.FormRow;\nimport org.joget.apps.form.model.FormRowSet;\nimport org.joget.apps.form.model.FormStoreBinder;\nimport java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport javax.sql.DataSource;\nimport org.joget.apps.form.service.FormUtil;\nimport org.joget.apps.app.model.AppDefinition;\nimport org.joget.commons.util.LogUtil;\n\n\npublic FormRowSet getStatusAgendamento() {\n    Connection con = null;\n    PreparedStatement stmt = null;\n    ResultSet rs = null;\n    String motivo = \"\";\n    String motivoLabel = \"\";\n    \n    AppDefinition appDef = AppUtil.getCurrentAppDefinition();\n    \n    \n    try{\n            DataSource ds = (DataSource)AppUtil.getApplicationContext().getBean(\"setupDataSource\");\n            con = ds.getConnection();\n            \n            if(!con.isClosed()){\n                \n                String idProcesso = \"#form.processos_procu.id#\";\n                \n                String queryGetLastAto = \"SELECT c_motivo_desmarcacao FROM app_fd_atos_procu WHERE c_id_processo = ? ORDER BY dateCreated DESC LIMIT 1\";\n                stmt = con.prepareStatement(queryGetLastAto);\n                stmt.setObject(1, idProcesso);\n                rs = stmt.executeQuery();\n                if(rs.next()){\n                    motivo = rs.getObject(\"c_motivo_desmarcacao\");\n                    String queryGetValueLabel = \"SELECT c_label FROM app_fd_listas_de_valores WHERE c_nome_campo = 'motivo_reagendamento' AND c_value = ?;\";\n                    stmt = con.prepareStatement(queryGetValueLabel);\n                    stmt.setObject(1, motivo);\n                    rs = stmt.executeQuery();\n                    if(rs.next()){\n                        motivoLabel = rs.getObject(\"c_label\");\n                    }\n                }\n                    \n            }\n            \n    }catch(Exception e){\n        LogUtil.error(appDef.toString(), e, \"Error getting info from DB\");\n    }finally{\n        try{\n            if(rs != null){\n            rs.close();\n            }\n            if(stmt != null){\n                stmt.close();\n            }\n            if(con != null && !con.isClosed()) {\n                con.close();\n            }\n        }catch(Exception e){\n            LogUtil.error(appDef.toString(), e, \"Error closing DB connection\");\n        }\n        \n    }\n    FormRowSet f = new FormRowSet();\n    FormRow r1 = new FormRow();\n    r1.put(FormUtil.PROPERTY_VALUE, motivo);\n    r1.put(FormUtil.PROPERTY_LABEL, motivoLabel);\n    f.add(r1);\n    return f;\n}\n \nreturn getStatusAgendamento();\n        ",
                                "useAjax": ""
                            }
                        },
                        "readonly": "",
                        "readonlyLabel": "",
                        "size": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.DatePicker",
                    "properties": {
                        "allowManual": "",
                        "currentDateAs": "",
                        "dataFormat": "yyyy-MM-dd",
                        "datePickerType": "dateTime",
                        "endDateFieldId": "",
                        "format": "",
                        "format24hr": "true",
                        "id": "data_conclusao",
                        "label": "Data de Conclusão",
                        "permission_rules": {
                            "1804038d-e85d-3ea4-4ef3-4c4143e5145b": {},
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {},
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "startDateFieldId": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": "",
                        "yearRange": "c-10:c+10"
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextField",
                    "properties": {
                        "encryption": "",
                        "id": "n_selo",
                        "label": "Nº do Selo",
                        "maxlength": "",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {},
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "size": "",
                        "storeNumeric": "",
                        "style": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.DatePicker",
                    "properties": {
                        "allowManual": "",
                        "currentDateAs": "",
                        "dataFormat": "yyyy-MM-dd",
                        "datePickerType": "",
                        "endDateFieldId": "",
                        "format": "",
                        "id": "rececao_originais",
                        "label": "Receção de Originais",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {
                                "permissionHidden": "true",
                                "readonly": ""
                            },
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "startDateFieldId": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": "",
                        "yearRange": "c-10:c+10"
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.DatePicker",
                    "properties": {
                        "allowManual": "",
                        "currentDateAs": "",
                        "dataFormat": "yyyy-MM-dd",
                        "datePickerType": "",
                        "endDateFieldId": "",
                        "format": "",
                        "id": "envio_originais_ao_cliente",
                        "label": "Envio dos Originais ao Cliente",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {
                                "permissionHidden": "true",
                                "readonly": ""
                            },
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "startDateFieldId": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": "",
                        "yearRange": "c-10:c+10"
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.DatePicker",
                    "properties": {
                        "allowManual": "",
                        "currentDateAs": "",
                        "dataFormat": "yyyy-MM-dd",
                        "datePickerType": "",
                        "endDateFieldId": "",
                        "format": "",
                        "id": "envio_crp_registos_averbados",
                        "label": "Envio da CRP com Registos Averbados",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {},
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "startDateFieldId": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": "",
                        "yearRange": "c-10:c+10"
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.CustomHTML",
                    "properties": {
                        "autoPopulate": "",
                        "id": "field6",
                        "label": "",
                        "permission_rules": {
                            "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                            "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                            "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                            "e0225c76-302c-9aba-4b69-9cce67038591": {},
                            "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                            "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {},
                            "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
                        },
                        "value": "<script>\n    $(document).ready(function(){\n        atualizarVisibilidadeBCP();\n        $(\"select[id*=status]\").prop(\"disabled\", \"disabled\");\n        $(\"select[id*=motivo]\").prop(\"disabled\", \"disabled\");\n        if(!$(\"select[id*=status]\").val().includes('DES')){\n            $(\"select[id*=motivo]\").parent().remove();\n        }\n        \n    });\n    \n    function atualizarVisibilidadeBCP(){\n        var tipoProcesso = \"#form.detalhe_proce_procu.tipo_processo[{form.processos_procu.detalhe_processo}]#\";\n        var banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\n        \n        console.log(\"Tipo \" +  tipoProcesso);\n        console.log(\"Banco \" + banco_fundo);\n        \n        if(banco_fundo === 'BCP'){\n            if(tipoProcesso === 'DIST' || tipoProcesso === 'MUT' || tipoProcesso === 'LEAS'){\n                $(\"input[id*=n_selo]\").parent().hide();\n                $(\"input[id*=envio_crp_registos_averbados]\").parent().hide();\n            }else{\n                $(\"input[id*=n_selo]\").parent().show();\n                $(\"input[id*=envio_crp_registos_averbados]\").parent().show();\n            }\n        } \n        \n    }\n    \n    \n    \n<\/script>"
                    }
                }
            ],
            "properties": {"width": "100%"}
        }],
        "properties": {
            "comment": "",
            "id": "section1",
            "join": "",
            "label": "Conclusão",
            "loadBinder": {
                "className": "",
                "properties": {}
            },
            "permission": {
                "className": "",
                "properties": {}
            },
            "permissionReadonly": "",
            "permission_rules": {
                "728ab7bc-8346-ae22-64f5-3a4815d79acc": {},
                "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3": {},
                "d1d6996e-389d-35e9-3acf-1f95d1c30cd1": {},
                "e0225c76-302c-9aba-4b69-9cce67038591": {},
                "f1926293-b24b-1c59-d60b-c0c9c520646f": {},
                "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba": {},
                "ffa341f0-9905-34c5-6ffb-8e1fdb024561": {}
            },
            "readonly": "",
            "readonlyLabel": "",
            "regex": "",
            "reverse": "",
            "storeBinder": {
                "className": "",
                "properties": {}
            },
            "visibilityControl": "",
            "visibilityValue": ""
        }
    }],
    "properties": {
        "description": "",
        "id": "conclusaoProcuradoria",
        "loadBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "name": "Procuradoria - Conclusão",
        "noPermissionMessage": "",
        "permission": {
            "className": "",
            "properties": {}
        },
        "permission_rules": [
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"MTG\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "d1d6996e-389d-35e9-3acf-1f95d1c30cd1",
                "permission_name": "MTG"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"BIC\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "728ab7bc-8346-ae22-64f5-3a4815d79acc",
                "permission_name": "BIC"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"BNI\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "f1926293-b24b-1c59-d60b-c0c9c520646f",
                "permission_name": "BNI"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"BCP\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "fac6bdeb-6e9c-3eb1-3ecf-80d489711aba",
                "permission_name": "BCP"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"HPG\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "ffa341f0-9905-34c5-6ffb-8e1fdb024561",
                "permission_name": "Hipoges (HPG)"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"NOR\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "83637e6f-3fe9-f5d3-0394-fb14a1ef53d3",
                "permission_name": "Norfin (NOR)"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco_fundo = \"#form.detalhe_proce_procu.banco_fundo[{form.processos_procu.detalhe_processo}]#\";\nif(banco_fundo.equals(\"WHS\")){\n    return true;\n}else{\n    return false;\n}\n"}
                },
                "permission_key": "e0225c76-302c-9aba-4b69-9cce67038591",
                "permission_name": "Whitestar (WHS)"
            }
        ],
        "postProcessor": {
            "className": "",
            "properties": {}
        },
        "postProcessorRunOn": "create",
        "storeBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "tableName": "conclusao_procu"
    }
}