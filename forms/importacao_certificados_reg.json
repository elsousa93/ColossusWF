{
    "className": "org.joget.apps.form.model.Form",
    "elements": [{
        "className": "org.joget.apps.form.model.Section",
        "elements": [{
            "className": "org.joget.apps.form.model.Column",
            "elements": [
                {
                    "className": "org.joget.apps.form.lib.SelectBox",
                    "properties": {
                        "controlField": "",
                        "id": "entidade",
                        "label": "Entidade Autenticadora",
                        "multiple": "",
                        "options": [],
                        "optionsBinder": {
                            "className": "org.joget.apps.form.lib.BeanShellFormBinder",
                            "properties": {
                                "cacheInterval": "",
                                "script": "import org.joget.apps.app.service.AppUtil;\r\nimport org.joget.apps.form.model.FormRow;\r\nimport org.joget.apps.form.model.FormRowSet;\r\nimport org.joget.apps.form.service.FormUtil;\r\nimport org.joget.apps.app.model.AppDefinition;\r\nimport org.joget.commons.util.LogUtil;\r\nimport org.joget.directory.model.service.ExtDirectoryManager;\r\nimport org.joget.plugin.base.Plugin;\r\nimport org.joget.plugin.base.PluginManager;\r\nimport org.joget.directory.model.User;\r\n\r\n \r\npublic FormRowSet load(String[] values) {\r\n    \r\n    LogUtil.info(\"String\", \"TESTEEEE \" );\r\n    \r\n    FormRowSet rows = new FormRowSet();\r\n    \r\n    FormRow option = new FormRow();\r\n    option.setProperty(FormUtil.PROPERTY_VALUE, \"\");\r\n    option.setProperty(FormUtil.PROPERTY_LABEL, \"\");\r\n    rows.add(option);\r\n    \r\n    //if (values != null && values.length > 0) {\r\n\r\n        String value = \"\";\r\n        String label = \"\";\r\n        \r\n        AppDefinition appDef = AppUtil.getCurrentAppDefinition();\r\n        \r\n        PluginManager pluginManager = (PluginManager) AppUtil.getApplicationContext().getBean(\"pluginManager\");\r\n        ExtDirectoryManager directoryManager = (ExtDirectoryManager) pluginManager.getBean(\"directoryManager\");\r\n        \r\n        String deptId = \"PL_INT_REG\";\r\n        String label = \"\";\r\n        \r\n        LogUtil.info(\"String\", \"DENTRO METODOOO \");\r\n        \r\n        Collection userList = directoryManager.getUserByDepartmentId(deptId);\r\n        for(Object u : userList) {\r\n            User user = (User) u;\r\n            FormRow option = new FormRow();\r\n            \r\n            value = user.getUsername();\r\n            label = user.getFirstName() + \" \" + user.getLastName();\r\n            \r\n            LogUtil.info(\"String\", \"Username: \" + user.getUsername());\r\n            \r\n            option.setProperty(FormUtil.PROPERTY_VALUE, value);\r\n            option.setProperty(FormUtil.PROPERTY_LABEL, label);\r\n            rows.add(option);\r\n        }\r\n        \r\n    //}\r\n\r\n    return rows;\r\n}\r\n \r\n//call load method with injected variable\r\nreturn load(values);",
                                "useAjax": ""
                            }
                        },
                        "readonly": "",
                        "readonlyLabel": "",
                        "size": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.HiddenField",
                    "properties": {
                        "id": "field3",
                        "useDefaultWhenEmpty": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.HiddenField",
                    "properties": {
                        "id": "field2",
                        "useDefaultWhenEmpty": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.FileUpload",
                    "properties": {
                        "attachment": "true",
                        "fileType": "",
                        "fileTypeMsg": "Tipo de ficheiro inválido",
                        "id": "ficheiro_certificado",
                        "label": "Certificado",
                        "maxSize": "",
                        "maxSizeMsg": "Limite do tamanho do ficheiro excedido",
                        "multiple": "",
                        "padding": "",
                        "permissionType": "",
                        "readonly": "",
                        "removeFile": "",
                        "resizeHeight": "",
                        "resizeMethod": "",
                        "resizeQuality": "0.8",
                        "resizeWidth": "",
                        "size": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        }
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.DatePicker",
                    "properties": {
                        "allowManual": "",
                        "currentDateAs": "",
                        "dataFormat": "yyyy-MM-dd",
                        "datePickerType": "",
                        "endDateFieldId": "",
                        "format": "",
                        "id": "data_expiracao",
                        "label": "Data de Expiração",
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "startDateFieldId": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": "",
                        "yearRange": "c-10:c+10"
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextArea",
                    "properties": {
                        "cols": "20",
                        "id": "notas",
                        "label": "Notas",
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "rows": "5",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                }
            ],
            "properties": {"width": "100%"}
        }],
        "properties": {
            "comment": "",
            "id": "section1",
            "join": "",
            "label": "Importar Certificado",
            "loadBinder": {
                "className": "",
                "properties": {}
            },
            "permission": {
                "className": "",
                "properties": {}
            },
            "permissionReadonly": "",
            "readonly": "",
            "readonlyLabel": "",
            "regex": "",
            "reverse": "",
            "storeBinder": {
                "className": "",
                "properties": {}
            },
            "visibilityControl": "",
            "visibilityValue": ""
        }
    }],
    "properties": {
        "description": "",
        "id": "importacao_certificados_reg",
        "loadBinder": {"className": "org.joget.apps.form.lib.WorkflowFormBinder"},
        "name": "Registos: Importação Certificados",
        "storeBinder": {"className": "org.joget.apps.form.lib.WorkflowFormBinder"},
        "tableName": "certificados_reg"
    }
}