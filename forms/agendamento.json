{
    "className": "org.joget.apps.form.model.Form",
    "elements": [
        {
            "className": "org.joget.apps.form.model.Section",
            "elements": [{
                "className": "org.joget.apps.form.model.Column",
                "elements": [{
                    "className": "org.joget.apps.form.lib.CustomHTML",
                    "properties": {
                        "autoPopulate": "",
                        "id": "field18",
                        "label": "",
                        "permission_rules": {
                            "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                            "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                            "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                            "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                            "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                            "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                            "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                            "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                            "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                            "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                            "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                        },
                        "value": "<div id=\"myErrorMsg\" class=\"alert alert-error\" role=\"alert\" style=\"font-size: 20px; font-weight: bold; color: red;\">\r\n  Existem erros de validação\r\n<\/div>\r\n<style>\r\n#myErrorMsg{\r\n    display:none;\r\n}\r\n<\/style>"
                    }
                }],
                "properties": {"width": "100%"}
            }],
            "properties": {
                "comment": "",
                "id": "section2",
                "join": "",
                "label": "",
                "loadBinder": {
                    "className": "",
                    "properties": {}
                },
                "permission": {
                    "className": "",
                    "properties": {}
                },
                "permissionReadonly": "",
                "permission_rules": {
                    "093a1241-e305-8c58-bf20-1cefd6a6df94": {
                        "permissionHidden": "",
                        "readonly": "true"
                    },
                    "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                    "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                    "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                    "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                    "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                    "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                    "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                    "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                    "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                    "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                },
                "readonly": "",
                "readonlyLabel": "",
                "regex": "",
                "reverse": "",
                "storeBinder": {
                    "className": "",
                    "properties": {}
                },
                "visibilityControl": "",
                "visibilityValue": ""
            }
        },
        {
            "className": "org.joget.apps.form.model.Section",
            "elements": [{
                "className": "org.joget.apps.form.model.Column",
                "elements": [
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "flag_notificacao_alteracoes",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                                "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                                "4dd344b6-5ff8-6608-a338-63d5c40ffc38": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                                "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                                "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                                "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                                "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                                "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "validar_alteracoes_agenda",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                                "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                                "4dd344b6-5ff8-6608-a338-63d5c40ffc38": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                                "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                                "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                                "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                                "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                                "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "",
                                    "script": "import java.util.Arrays;\r\nimport org.joget.apps.app.service.AppUtil;\r\nimport org.joget.apps.form.model.Element;\r\nimport org.joget.apps.form.model.Form;\r\nimport org.joget.apps.form.model.FormData;\r\nimport org.joget.apps.form.service.FormUtil;\r\nimport org.joget.commons.util.LogUtil;\r\nimport java.sql.Connection;\r\nimport java.sql.PreparedStatement;\r\nimport java.sql.ResultSet;\r\nimport java.sql.SQLException;\r\nimport javax.sql.DataSource;\r\n\r\n \r\npublic boolean validate(Element element, FormData formData, String[] values) {\r\n    boolean result = true;\r\n    \r\n    String processId = \"#form.processos.id#\";\r\n    Form form = FormUtil.findRootForm(element);\r\n    Element atos = FormUtil.findElement(\"atos\", form, formData);\r\n    String idAtos = FormUtil.getElementParameterName(atos);\r\n    \r\n    Connection con = null;\r\n    PreparedStatement stmt = null;\r\n    ResultSet rs = null;\r\n    try{\r\n        DataSource ds = (DataSource)AppUtil.getApplicationContext().getBean(\"setupDataSource\");\r\n        con = ds.getConnection();\r\n            \r\n        if(!con.isClosed()){\r\n        \r\n            String queryGetMaxAlteracoes = \"SELECT MAX(c_flag_alteracoes_agenda) as max FROM app_fd_atos WHERE c_id_processo = ? ;\";\r\n            stmt = con.prepareStatement(queryGetMaxAlteracoes);\r\n            stmt.setObject(1, processId);\r\n            rs = stmt.executeQuery();\r\n            if(rs.next()){\r\n                String max = rs.getObject(\"max\");\r\n                if(max!=null && max.equals(\"1\")){\r\n                    result = false;  \r\n                    formData.addFormError(idAtos, \"Houve alterações nos Atos pela Agenda. O processo vai ter de ser atualizado.\");\r\n                }\r\n            }\r\n        }\r\n        \r\n    }catch(Exception e){\r\n            LogUtil.error(\"Olimpo- Validator Agendamento Alterações\", e, \"Error getting info from DB\");\r\n    }finally{\r\n        try{\r\n            if(rs != null){\r\n            rs.close();\r\n            }\r\n            if(stmt != null){\r\n                stmt.close();\r\n            }\r\n            if(con != null && !con.isClosed()) {\r\n                con.close();\r\n            }\r\n        }catch(Exception e){\r\n            LogUtil.error(\"Olimpo- Validator Agendamento Alterações\", e, \"Error closing DB connection\");\r\n        }\r\n        \r\n    }\r\n    \r\n \r\n    return result;\r\n}\r\n \r\n//call validate method with injected variable\r\nreturn validate(element, formData, values);\r\n//return true;"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "flag_agendado",
                            "permission_rules": {
                                "03c775dc-a743-e094-4e35-cf487b91cef2": {},
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                                "2f7e0d1d-ee44-6d46-f4bc-434ed5e08f53": {},
                                "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                                "5173a640-6d7b-ff47-1db9-349049a3ee8f": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "61eed640-2e15-cba4-8522-d7b5ae130f31": {},
                                "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                                "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                                "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "7e7faade-f35a-329d-a7a9-b6b63b1bc5b4": {},
                                "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                                "d4230f5d-0b67-d8a3-8845-6d41ad2f225b": {},
                                "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                                "dd84b73a-a59f-28e2-68ab-489586ddeac1": {},
                                "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "flag_alerta_agendamento",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "flag_alerta_agendamento_swift",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "atualizar_envio_processo",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.HiddenField",
                        "properties": {
                            "id": "pid_agenda",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "useDefaultWhenEmpty": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextField",
                        "properties": {
                            "encryption": "",
                            "id": "n_wf_agendamento",
                            "label": "Número Workflow Agendamento",
                            "maxlength": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "storeNumeric": "",
                            "style": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.Radio",
                        "properties": {
                            "controlField": "",
                            "id": "urgencia_agendamento",
                            "label": "Urgência de Agendamento",
                            "options": [
                                {
                                    "grouping": "",
                                    "label": "Sim",
                                    "value": "SIM"
                                },
                                {
                                    "grouping": "",
                                    "label": "Não",
                                    "value": "NAO"
                                }
                            ],
                            "optionsBinder": {
                                "className": "",
                                "properties": {}
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextArea",
                        "properties": {
                            "cols": "20",
                            "id": "motivo_urgencia_agendamento",
                            "label": "Motivo de Urgência de Agendamento",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "rows": "5",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "",
                                    "script": "import java.util.Arrays;\r\nimport org.joget.apps.app.service.AppUtil;\r\nimport org.joget.apps.form.model.Element;\r\nimport org.joget.apps.form.model.Form;\r\nimport org.joget.apps.form.model.FormData;\r\nimport org.joget.apps.form.service.FormUtil;\r\nimport org.joget.commons.util.LogUtil;\r\n  \r\npublic boolean validate(Element element, FormData formData, String[] fileUploadValues) {\r\n    boolean result = true;\r\n     \r\n    //get dropdown select box value\r\n    String field1Id = \"urgencia_agendamento\";\r\n    Form form = FormUtil.findRootForm(element);\r\n    Element field1 = FormUtil.findElement(field1Id, form, formData);\r\n  \r\n    if (field1 != null) {\r\n        //get value of field 1\r\n        String[] field1Values = FormUtil.getElementPropertyValues(field1, formData);\r\n  \r\n        /*if(field1Values[0].equalsIgnoreCase(\"sim\") && fileUploadValues[0].isEmpty() ){*/\r\n        if(field1Values.length != 0 && fileUploadValues.length != 0){\r\n            if(field1Values[0].equalsIgnoreCase(\"sim\")  && fileUploadValues[0].isEmpty()){\r\n                String id = FormUtil.getElementParameterName(element);\r\n                formData.addFormError(id, \"Campo obrigatório quando existe Urgência de Agendamento\");\r\n                result = false;\r\n            }\r\n        }\r\n    } else {\r\n        //ignore if the dropdown does not exist\r\n    }\r\n  \r\n    return result;\r\n}\r\n  \r\n//call validate method with injected variable\r\nreturn validate(element, formData, values);"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.SelectBox",
                        "properties": {
                            "controlField": "",
                            "id": "distrito",
                            "label": "Distrito",
                            "multiple": "",
                            "options": [],
                            "optionsBinder": {
                                "className": "org.joget.apps.form.lib.FormOptionsBinder",
                                "properties": {
                                    "addEmptyOption": "true",
                                    "cacheInterval": "",
                                    "emptyLabel": "",
                                    "extraCondition": "",
                                    "formDefId": "distritosConcelhos",
                                    "groupingColumn": "",
                                    "idColumn": "distrito",
                                    "labelColumn": "distrito",
                                    "useAjax": ""
                                }
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.SelectBox",
                        "properties": {
                            "controlField": "distrito",
                            "id": "concelho",
                            "label": "Concelho",
                            "multiple": "",
                            "options": [],
                            "optionsBinder": {
                                "className": "org.joget.apps.form.lib.FormOptionsBinder",
                                "properties": {
                                    "addEmptyOption": "true",
                                    "cacheInterval": "",
                                    "emptyLabel": "",
                                    "extraCondition": "",
                                    "formDefId": "distritosConcelhos",
                                    "groupingColumn": "distrito",
                                    "idColumn": "concelho",
                                    "labelColumn": "concelho",
                                    "useAjax": "true"
                                }
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextField",
                        "properties": {
                            "encryption": "",
                            "id": "local",
                            "label": "Local",
                            "maxlength": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "storeNumeric": "",
                            "style": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.Radio",
                        "properties": {
                            "controlField": "",
                            "id": "contacto",
                            "label": "Contactar",
                            "options": [
                                {
                                    "grouping": "",
                                    "label": "Cliente",
                                    "value": "CLT"
                                },
                                {
                                    "grouping": "",
                                    "label": "Balcão",
                                    "value": "BLC"
                                },
                                {
                                    "grouping": "",
                                    "label": "Ambos",
                                    "value": "ABS"
                                }
                            ],
                            "optionsBinder": {
                                "className": "",
                                "properties": {}
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {
                                    "permissionHidden": "true",
                                    "readonly": ""
                                },
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {
                                    "permissionHidden": "true",
                                    "readonly": ""
                                },
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "*",
                                    "script": "return true;"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextField",
                        "properties": {
                            "encryption": "",
                            "id": "telefone_cliente",
                            "label": "Telefone do Cliente",
                            "maxlength": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "storeNumeric": "",
                            "style": "",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "*",
                                    "script": "return true;"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextField",
                        "properties": {
                            "encryption": "",
                            "id": "email_cliente",
                            "label": "Email do Cliente",
                            "maxlength": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "storeNumeric": "",
                            "style": "",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "*",
                                    "script": "return true;"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.SelectBox",
                        "properties": {
                            "controlField": "",
                            "id": "localizacao_imovel",
                            "label": "Localização do Imóvel",
                            "multiple": "",
                            "options": [],
                            "optionsBinder": {
                                "className": "org.joget.apps.form.lib.FormOptionsBinder",
                                "properties": {
                                    "addEmptyOption": "true",
                                    "cacheInterval": "",
                                    "emptyLabel": "",
                                    "extraCondition": "c_nome_campo = 'local_imovel'",
                                    "formDefId": "adicionarOpcaoLV",
                                    "groupingColumn": "",
                                    "idColumn": "value",
                                    "labelColumn": "label",
                                    "useAjax": ""
                                }
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "size": "",
                            "validator": {
                                "className": "org.joget.apps.form.lib.BeanShellValidator",
                                "properties": {
                                    "decoration": "*",
                                    "script": "return true;"
                                }
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.Radio",
                        "properties": {
                            "controlField": "",
                            "id": "pre_agendamento",
                            "label": "Pre-agendamento",
                            "options": [
                                {
                                    "grouping": "",
                                    "label": "Sim",
                                    "value": "SIM"
                                },
                                {
                                    "grouping": "",
                                    "label": "Não",
                                    "value": "NAO"
                                }
                            ],
                            "optionsBinder": {
                                "className": "",
                                "properties": {}
                            },
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.DatePicker",
                        "properties": {
                            "allowManual": "",
                            "currentDateAs": "",
                            "dataFormat": "yyyy-MM-dd",
                            "datePickerType": "",
                            "endDateFieldId": "",
                            "format": "",
                            "id": "data_solicitada",
                            "label": "Data Solicitada",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "startDateFieldId": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": "",
                            "yearRange": "c-10:c+10"
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.DatePicker",
                        "properties": {
                            "allowManual": "",
                            "datePickerType": "timeOnly",
                            "endDateFieldId": "",
                            "format24hr": "true",
                            "id": "hora_solicitada",
                            "label": "Hora Solicitada",
                            "permission_rules": {
                                "03c775dc-a743-e094-4e35-cf487b91cef2": {},
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                                "2f7e0d1d-ee44-6d46-f4bc-434ed5e08f53": {},
                                "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                                "5173a640-6d7b-ff47-1db9-349049a3ee8f": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "61eed640-2e15-cba4-8522-d7b5ae130f31": {},
                                "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                                "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                                "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "7e7faade-f35a-329d-a7a9-b6b63b1bc5b4": {},
                                "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                                "d4230f5d-0b67-d8a3-8845-6d41ad2f225b": {},
                                "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                                "dd84b73a-a59f-28e2-68ab-489586ddeac1": {},
                                "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "startDateFieldId": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.CheckBox",
                        "properties": {
                            "controlField": "",
                            "id": "volta_a_entrar",
                            "label": "VOLTA A ENTRAR",
                            "options": [{
                                "grouping": "",
                                "label": "",
                                "value": "SIM"
                            }],
                            "optionsBinder": {
                                "className": "",
                                "properties": {}
                            },
                            "readonly": "",
                            "readonlyLabel": "",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextArea",
                        "properties": {
                            "cols": "20",
                            "id": "observacoes_automaticas",
                            "label": "Observações Automáticas",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {
                                    "permissionHidden": "",
                                    "readonly": ""
                                },
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "rows": "13",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.TextArea",
                        "properties": {
                            "cols": "20",
                            "id": "observacoes_agendamento",
                            "label": "Observações  Adicionais",
                            "permissionHidden": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                    "permissionHidden": "",
                                    "readonly": "true"
                                },
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "placeholder": "",
                            "readonly": "",
                            "readonlyLabel": "",
                            "rows": "10",
                            "validator": {
                                "className": "",
                                "properties": {}
                            },
                            "value": "Validade CRP:\nValidade Direitos de Preferência:",
                            "workflowVariable": ""
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.CustomHTML",
                        "properties": {
                            "autoPopulate": "",
                            "id": "field17",
                            "label": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "value": "<input id=\"agendar\" type=\"button\" value=\"PEDIR AGENDAMENTO\">"
                        }
                    },
                    {
                        "className": "org.joget.apps.form.lib.CustomHTML",
                        "properties": {
                            "autoPopulate": "",
                            "id": "field12",
                            "label": "",
                            "permission_rules": {
                                "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                                "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                                "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                                "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                                "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                                "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                                "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                                "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                                "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                                "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                                "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                                "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                            },
                            "value": "<script>\nvar nWfBanco, banco, emailGestor, outroEmailGestor, complexidade, emailCliente, telefoneCliente, nomeCliente, idCliente, tipoDeProcesso, dataAgendamento, \ndistrito, concelho, contactar, estadoCivil, tipoCliente, nifCliente, obsAutomaticas, obsManuais, endereco, localidade, codigoPostal, pais, localizacaoImovel, flagMultiLocalizacao,\ndataSolicitada, horaSolicitada, nWfPl, nWfAgendamento, urgencia, motivoUrgencia, preAgendamento,local, origemProcesso, emailBalcao, dataSwift, dataFine,  procurador_banco, processoVip\n\n    $(window).load(function(){\n         var flag_validacao = '#variable.flag_validacao#';\n         \n        \n        $(\"form#processo :input\").change(function(){\n            if(flag_validacao === '1' || flag_validacao.startsWith(\"#variable.flag_validacao\")){\n                $(\"input#flag_alteracoes\").attr(\"value\",\"SIM\");   \n            }\n            \n            $(\"input#agendar\").prop(\"disabled\", false);\n        });\n        \n        var mode = \"#requestParam._mode#\";\n        //Caso o seja modo de consulta remover o botão de \"Pedir Agendamento\"\n        if(mode!=='assignment'){\n            $(\"input#agendar\").parent().hide();\n             $(\"div[id*=mensagemAgendamento]\").hide();\n        }\n        \n    });\n    \n    $(document).ready(function(){\n        //Atualizar valor do hidden field do envio_processo\n        $('input[id*=atualizar_envio_processo]').val(\"#form.detalhe_processo.envio_processo[{form.processos.detalhe_processo}]#\");\n        \n        if($(\"input[id*=flag_agendado]\").val() === '1'){\n            $(\"div[id*=agendamento_informacao_geral]\").hide();\n        }\n        \n        urgencia = $(\"input[id*=urgencia_agendamento]:checked\").val();\n        if(urgencia=== undefined){\n            urgencia = '';\n        }\n        if(urgencia !== 'SIM'){\n            $(\"textarea[id*=motivo_urgencia_agendamento]\").parent().hide();\n            motivoUrgencia=\"\";\n        }\n        \n        $(\"textarea[id*=observacoes_agendamento]\").change(function(){\n            obsManuais = $(\"textarea[id*=observacoes_agendamento]\").val();\n        });\n        \n        \n        $(\"input[id*=urgencia_agendamento]\").change(function(){\n            urgencia = $(\"input[id*=urgencia_agendamento]:checked\").val();\n            if(urgencia === undefined){\n                urgencia = '';\n            }\n            if(urgencia === 'NAO' || urgencia === ''){\n                $(\"textarea[id*=motivo_urgencia_agendamento]\").parent().hide();\n                motivoUrgencia = \"\";\n                \n            }else{\n                $(\"textarea[id*=motivo_urgencia_agendamento]\").parent().show();\n                motivoUrgencia = $(\"textarea[id*=motivo_urgencia_agendamento]\").val();\n                \n            }\n            atualizarObservacoes();\n        });\n        \n        \n        $(\"textarea[id*=motivo_urgencia_agendamento]\").change(function(){\n            motivoUrgencia = $(\"textarea[id*=motivo_urgencia_agendamento]\").val();\n            if($(\"input[id*=urgencia_agendamento]:checked\").val() !== 'SIM'){\n                motivoUrgencia = \"\";\n            }\n            atualizarObservacoes();\n        });\n        \n        preAgendamento =  $(\"input[id*=pre_agendamento]:checked\").val();\n        $(\"input[id*=pre_agendamento]\").change(function(){\n            preAgendamento =  $(\"input[id*=pre_agendamento]:checked\").val();\n            atualizarObservacoes();\n        });\n        \n        \n        $(\"input[id*=volta_a_entrar]\").change(function(){\n            if($(this).is(\":checked\")){\n                $.datepicker._clearDate($(\"input[id*=hora_solicitada]\"));\n            }\n            atualizarObservacoes();\n            \n        });\n        \n        //Esconder botão para avançar atividade\n        $(\"input#assignmentComplete\").remove();\n        \n        //Esconder campos de contacto do cliente\n        $(\"input[id*=telefone_cliente]\").parent().hide();\n        $(\"input[id*=email_cliente]\").parent().hide();\n        //Observações automaticas como readonly\n        $(\"textArea[id*=observacoes_automaticas]\").attr('readonly','readonly');\n   \n        \n        //Dados processo\n        nWfBanco = \"#form.detalhe_processo.n_wf_banco[{form.processos.detalhe_processo}]#\";\n        nWfPl = \"#form.detalhe_processo.n_wf_pl[{form.processos.detalhe_processo}]#\";\n        banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\n        emailGestor = \"#form.banco.email_gestor[{form.processos.banco}]#\";\n        outroEmailGestor = \"#form.banco.outro_email_gestor[{form.processos.banco}]#\";\n        emailBalcao = \"#form.banco.email_balcao_bcp[{form.processos.banco}]#\";\n        complexidade = \"#form.detalhe_processo.complex_processo[{form.processos.detalhe_processo}]#\";\n        tipoDeProcesso = \"#form.detalhe_processo.tipo_processo[{form.processos.detalhe_processo}]#\";\n        dataAgendamento = $(\"input[id*=data_solicitada]\").val() + \" \" + $(\"input[id*=hora_solicitada]\").val();\n        distrito = $(\"select[id*=distrito]\").val();\n        concelho = $(\"select[id*=concelho]\").val();\n        local = $(\"input[id*=local]\").val();\n        contactar = $(\"div[id*=contacto] input:checked\").val();\n        obsAutomaticas = $(\"textarea[id*=observacoes_automaticas]\").val();\n        obsManuais = $(\"textarea[id*=observacoes_agendamento]\").val();\n        //Cliente Principal\n        emailCliente = \"\";\n        telefoneCliente = \"\";\n        nomeCliente = \"\";\n        idCliente = \"\";\n        tipoCliente = \"\";\n        nifCliente = \"\";\n        estadoCivil = \"\";\n        endereco = \"\";\n        localidade = \"\";\n        codigoPostal = \"\";\n        pais = \"\";\n        localizacaoImovel = \"\";\n        flagMultiLocalizacao = 0;\n        origemProcesso = \"#form.detalhe_processo.origem_processo[{form.processos.detalhe_processo}]#\";\n        dataSwift = \"#form.anal_banc_processo.data_swift[{form.processos.anal_banc}]#\";\n        dataFine = \"#form.anal_banc_processo.data_fine_agendamento[{form.processos.anal_banc}]#\";\n        procurador_banco =  \"#form.anal_banc_processo.procurador_b[{form.processos.anal_banc}]#\";\n        processoVip = \"#form.detalhe_processo.processo_vip[{form.processos.detalhe_processo}]#\";\n        \n        \n        \n        //Esconder localização do Imóvel\n        $(\"select[id*=localizacao_imovel]\").parent().hide();\n        \n        \n        //Caso o NWF Agendamento esteja vazio é assumido o valor do NWF PL\n        if($(\"input[id*=n_wf_agendamento]\").val() === ''){\n            $(\"input[id*=n_wf_agendamento]\").val(nWfPl);\n        }\n        \n        nWfAgendamento = $(\"input[id*=n_wf_agendamento]\").val();\n \n        switch(banco){\n            case \"MTG\":\n                emailGestor = \"#form.banco.email_gestor_mtg[{form.processos.banco}]#\";\n                outroEmailGestor = \"#form.banco.outro_email_gestor_mtg[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_mtg[{form.processos.banco}]#\";\n                break;\n            \n            case \"BIC\":\n                emailGestor = \"#form.banco.email_gestor_bic[{form.processos.banco}]#\";\n                outroEmailGestor = \"#form.banco.outro_email_gestor_bic[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_bic[{form.processos.banco}]#\";\n                break;\n                \n            case \"BST\":\n                emailGestor = \"#form.banco.email_gestor_bst[{form.processos.banco}]#\";\n                outroEmailGestor = \"#form.banco.outro_email_gestor_bst[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_bst[{form.processos.banco}]#\";\n                break;\n            \n            case \"NVB\":\n                emailGestor = \"#form.banco.email_gestor_nvb[{form.processos.banco}]#\";\n                outroEmailGestor = \"#form.banco.outro_email_gestor_nvb[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_nvb[{form.processos.banco}]#\";\n                break;\n            case \"ABN\":\n                emailGestor = \"#form.banco.email_gestor_abn[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_abn[{form.processos.banco}]#\";\n                break;\n            case \"BNI\":\n                emailGestor = \"#form.banco.email_gestor_bni[{form.processos.banco}]#\";\n                emailBalcao = \"#form.banco.email_balcao_bni[{form.processos.banco}]#\";\n                break;\n        }\n        \n        if(emailGestor === \"\"){\n            emailGestor = outroEmailGestor;\n        }\n        \n        if(complexidade === \"COM\"){\n            complexidade= \"Complexo\";\n        }else{\n            complexidade=\"Normal\";\n        }\n        \n        if(procurador_banco === \"SIM\"){\n            procurador_banco = \"Sim\";\n        }else{\n             procurador_banco = \"Não\";\n        }\n        \n         if(processoVip === \"0\"){\n            processoVip = \"Não\";\n        }else{\n             processoVip = \"Sim\";\n        }\n        \n        //Obter informação do interveniente principal\n        $.ajax({\n            type:\"GET\",\n                url: \"/jw/api/list/listIntervenientesPrincipais?c_id_processo=\" + \"#form.processos.id#\",\n                headers:{\n                    \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n                    \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n                    \"Accept\":\"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },\n                success: function(data){\n                    if(data.total!=undefined && data.total > 0){\n                        idCliente = data.data[0].id;\n                        emailCliente = data.data[0].c_email;\n                        telefoneCliente = data.data[0].c_telefone;\n                        nomeCliente = data.data[0].c_nome;\n                        estadoCivil = data.data[0].c_estado_civil;\n                        tipoCliente = data.data[0].c_interveniente_soc_part;\n                        nifCliente= data.data[0].c_nif;\n                        endereco = data.data[0].c_endereco;\n                        localidade = data.data[0].c_localidade;\n                        codigoPostal = data.data[0].c_codigo_postal;\n                        pais = data.data[0].c_pais;\n                    }\n                    \n                    atualizarObservacoes();\n                    \n                    //Se for para contactar o cliente\n                    if(contactar === 'CLT' || contactar === 'ABS'){\n                        if(emailCliente===''){\n                            $(\"input[id*=email_cliente]\").parent().show();                    \n                        }\n                        if(telefoneCliente === ''){\n                            $(\"input[id*=telefone_cliente]\").parent().show();\n                        }\n                    }\n                }\n        });\n        \n        //Obter localizacao de imoveis\n        $.ajax({\n            type:\"GET\",\n                url: \"/jw/api/list/listImoveis?c_id_processo=\" + \"#form.processos.id#\",\n                headers:{\n                    \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n                    \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n                    \"Accept\":\"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },\n                success: function(data){\n                    if(data.total!=undefined && data.total > 0){\n                        var total = data.total - 1;\n                        var countCOM = 0;\n                        var countACO = 0;\n                        var countMAD = 0;\n                        var localFinal = \"\";\n                        while(total>=0){\n                            var localImovel = data.data[total].c_local_imovel;\n                            if(localImovel !== ''){\n                                localFinal = localImovel;\n                                if(localImovel === 'COM'){\n                                    countCOM +=1;\n                                }else if(localImovel === 'ACO'){\n                                    countACO +=1;\n                                }else if(localImovel === 'MAD'){\n                                    countMAD +=1;\n                                }\n                            }\n                            \n                            total-=1;\n                        }\n                        \n                        if((countCOM > 0 && (countACO + countMAD) > 0) || (countACO > 0 && (countCOM + countMAD) > 0 ) || (countMAD > 0 && (countCOM + countACO ) > 0) || (countCOM + countACO + countMAD == 0)){\n                            $(\"select[id*=localizacao_imovel]\").parent().show();\n                            flagMultiLocalizacao = 1;\n                        }else{\n                            localizacaoImovel = localFinal;\n                        }\n                    }\n                }\n        });\n        \n        \n        \n        //Se a data de agendamento sofrer alterações atualiza os valores na textarea\n       $(\"input[id*=data_solicitada]\").on('change', function(){\n            dataAgendamento = $(\"input[id*=data_solicitada]\").val() + \" \" + $(\"input[id*=hora_solicitada]\").val();\n            atualizarObservacoes();\n        });\n        $(\"input[id*=hora_solicitada]\").on('change', function(){\n            dataAgendamento = $(\"input[id*=data_solicitada]\").val() + \" \" + $(\"input[id*=hora_solicitada]\").val();\n            atualizarObservacoes();\n        });\n        \n        //Se o distrito sofrer alterações atualiza os valores na textarea\n        $(\"select[id*=distrito]\").on('change', function(){\n            distrito = $(\"select[id*=distrito]\").val();\n            atualizarObservacoes();\n        });\n        \n        //Se concelho sofrer alterações atualiza os valores na textarea\n        $(\"select[id*=concelho]\").on('change', function(){\n            concelho = $(\"select[id*=concelho]\").val();\n             atualizarObservacoes();\n        });\n        \n        //Se Local sofrer alterações atualiza os valores na textarea\n        $(\"input[id*=local]\").change(function(){\n           local = $(\"input[id*=local]\").val();\n            atualizarObservacoes();\n        });\n        \n        //Se NWFAgenda sofrer alterações atualiza os valores na textarea\n        $(\"input[id*=n_wf_agendamento]\").change(function(){\n            nWfAgendamento = $(\"input[id*=n_wf_agendamento]\").val();\n            atualizarObservacoes();\n        });\n        \n        \n        $(\"select[id*=localizacao_imovel]\").change(function(){\n           localizacaoImovel = $(\"select[id*=localizacao_imovel]\").val(); \n        });\n        \n        \n        //Se o contacto sofrer alterações verificar se os campos de contacto estão preencidos\n        $(\"div[id*=contacto] input\").on('change', function(){\n            contactar = $(\"div[id*=contacto] input:checked\").val();  \n            if(contactar === 'BLC'){\n                $(\"div[id*=contacto]\").css(\"border\", \"none\");\n                $(\"input[id*=telefone_cliente]\").parent().hide();\n                $(\"input[id*=email_cliente]\").parent().hide();\n            }else if(contactar === 'CLT' || contactar === 'ABS' ){\n                $(\"div[id*=contacto]\").css(\"border\", \"none\");\n                if(telefoneCliente == null || telefoneCliente === ''){\n                    $(\"input[id*=telefone_cliente]\").parent().show();    \n                }\n                \n                if(emailCliente == null || emailCliente === ''){\n                    $(\"input[id*=email_cliente]\").parent().show();\n                }\n            }else{\n                $(\"input[id*=telefone_cliente]\").parent().hide();\n                $(\"input[id*=email_cliente]\").parent().hide();\n            }\n            atualizarObservacoes();\n            \n        });\n  \n            \n        $(\"input#agendar\").click(function(){\n            $(this).prop(\"disabled\", true);\n            //Validar data e Hora Solicitada\n            var validDataEHora = validadeDataEHoraSolicitada();\n            \n            //Validar localização\n            var validLocalizacao = validateLocalizacao();\n            //Caso o campo Contactar não esteja visivel \n            if($(\"div[id*=contacto]\").length == 0 && validDataEHora && validLocalizacao){\n                atualizarObservacoes();\n                criarAto();\n            \n            }else{\n                //Validar contacto do cliente\n                if(contactar === 'CLT' || contactar === 'ABS'){\n                    var validEmailCliente = true;\n                    \n                    //Se o cliente não tiver email, validar o email inserido no campo e atualizar variável\n                    if(emailCliente == null || emailCliente === ''){\n                        validEmailCliente = validateEmail();\n                        emailCliente = $(\"input[id*=email_cliente]\").val();\n                    }\n                    \n                    //Se o cliente não tiver telefone, validar telefone inserido no campo e atualizar variável\n                    var validTelefoneCliente = true;\n                    if(telefoneCliente == null || telefoneCliente === ''){\n                        validTelefoneCliente = validateTelefone();\n                        telefoneCliente = $(\"input[id*=telefone_cliente]\").val();\n                    }\n                    \n    \n                    if(validDataEHora && validEmailCliente && validTelefoneCliente && validLocalizacao){\n                        \n                        //Atualizar dados do Cliente   \n                        $.ajax({\n                            type:\"POST\",\n                            url: \"/jw/api/form/interveniente/saveOrUpdate\",\n                            headers:{\n                                \"api_id\": \"#envVariable.apiIdAtualizarCampos#\",\n                                \"api_key\": \"#envVariable.apiKeyAtualizarCampos#\",\n                                \"accept\":\"application/json\",\n                                \"Content-Type\": \"application/json\"\n                            },\n                            data: JSON.stringify({\n                                            \"id\": idCliente,\n                                            \"email\": emailCliente,\n                                            \"telefone\": telefoneCliente,\n                                            \"estado_civil\": estadoCivil  //Por razões desconhecidas só funciona se atualizar o estado civil\n                                        }),\n                            success: function(data){\n                                atualizarObservacoes();\n                                //Esconder campos de contacto do cliente\n                                $(\"input[id*=telefone_cliente]\").parent().hide();\n                                $(\"input[id*=email_cliente]\").parent().hide();\n    \n                                criarAto();\n                            }\n                        });\n    \n                    }\n                }else if(contactar === 'BLC' && validDataEHora && validLocalizacao){\n                    //pedirAgendamento();\n                    atualizarObservacoes();\n                    criarAto();\n                    //location.reload();\n                }else if(contactar == undefined || contactar === ''){\n                    $(\"div[id*=contacto]\").css(\"border\", \"1px solid red\");\n                }\n            }\n        });\n     \n    });\n    \n    \n    $(document).change(function(){\n        var status = FormUtil.getValues(\"atos.status\");\n        var flagAGN = false;\n        flagDesmarcado = false;\n        \n        if(status.length>0){\n            //Se existir atos Desmarcados\n            if(status[status.length-1].indexOf('DES') !== -1 || status[status.length-1].indexOf('NOUT') !== -1 || status[status.length-1].indexOf('RJD') !== -1){\n                flagDesmarcado = true;\n            }\n        }\n        \n            //Caso não existam atos desmarcados ou não haja nenhum pedido de agendamento\n            if(!flagDesmarcado || $(\"input[id*=flag_agendado]\").val() === '0'){\n                $(\"div[id*=mensagemAgendamento]\").hide();\n            }else{\n                $(\"div[id*=mensagemAgendamento]\").show();\n            }\n    \n    });\n    \n    function atualizarObservacoes(){\n        var obsAut = \"\";\n        if($(\"input[id*=volta_a_entrar]\").is(\":checked\")){\n            obsAut += \"VOLTAR A ENTRAR\\n\";\n        }\n        obsAut += \"Urgência:\" + urgencia + \"\\nNome Cliente - \" + nomeCliente + \"\\n\" + \"Número Processo - \" + nWfAgendamento + \"\\n\" + \"Data Agendamento - \" + dataAgendamento \n                    + \"\\n\" + \"Local - \" + \"\\n\" +\"    Distrito: \" + distrito + \"\\n\" + \"    Concelho: \" + concelho + \"\\n\" + \"    Local: \" + local + \"\\n\";\n        \n        if(contactar === 'CLT' || contactar === 'ABS'){\n            obsAut = obsAut + \"Telefone Cliente- \" + telefoneCliente + \"\\n\" + \"Email Cliente- \" + emailCliente + \"\\n\";\n        }\n        \n        obsAut = obsAut +  \"Email Gestor - \" + emailGestor +  \"\\n\" + \"Email Balcão - \" + emailBalcao + \"\\n\" + \"Tipo de Processo - \" + tipoDeProcesso + \"\\n\" + \"Origem do Processo - \" + origemProcesso +  \"\\n\" + \"Complexidade - \" + complexidade;\n        \n        \n\n        if(urgencia === 'SIM'){\n            obsAut =  obsAut + \"\\nMotivo Urgencia:\" + motivoUrgencia;\n        }\n        if(preAgendamento === 'SIM'){\n            obsAut = obsAut + \"\\nPre-agendamento:\" + preAgendamento;\n        }\n        var temCampanha = \"#form.anal_banc_processo.tem_campanha[{form.processos.anal_banc}]#\";\n        if(temCampanha === 'SIM'){\n            var campanha = \"#form.anal_banc_processo.campanhas[{form.processos.anal_banc}]#\";\n            if(campanha !== ''){\n                 obsAut = obsAut + \"\\nCampanha:\" + campanha;\n            }\n        }\n        \n        if(dataSwift !== ''){\n            obsAut = obsAut + \"\\nData Swift/Declaração de dívida - \" + dataSwift;\n        }\n        \n        if(dataFine !== ''){\n            obsAut = obsAut + \"\\nData FINE - \" + dataFine;\n            \n        }\n        if(procurador_banco !== ''){\n            obsAut = obsAut + \"\\nProcurador Banco - \" + procurador_banco;\n            \n        }\n        if(processoVip !== ''){\n            obsAut = obsAut + \"\\nProcesso VIP - \" + processoVip;\n            \n        }\n        \n        $(\"textarea[id*=observacoes_automaticas]\").val(obsAut);\n        obsAutomaticas =$(\"textarea[id*=observacoes_automaticas]\").val();\n    }\n  \n    \n    function validateEmail(){\n        var email = $(\"input[id*=email_cliente]\").val();\n        var emailRegex = /^[\\w-\\.]+@([\\w-]+\\.)+[\\w-]{2,4}$/;\n        var result = false;\n        if(email !== ''){\n            result = emailRegex.test(email);\n            if(result==false){\n                $(\"input[id*=email_cliente]\").css(\"border\", \"1px solid red\");\n                $('#myErrorMsg').fadeIn('fast');    \n                $(window).scrollTop(500);\n                $.unblockUI();\n            }\n        }else{\n            $(\"input[id*=email_cliente]\").css(\"border\", \"1px solid red\");\n            $(\"input[id*=email_cliente]\").attr('placeholder', \"CAMPO OBRIGATÓRIO\");\n            $(window).scrollTop(500);\n        }\n         \n        return result;\n    }\n    \n    function validateTelefone(){\n        var telefone = $(\"input[id*=telefone_cliente]\").val();\n        var telefoneRegex = /^[+]*[(]{0,1}[0-9]{1,4}[)]{0,1}[-\\s\\./0-9]*$/;\n        var result = false;\n        if(telefone !== ''){\n            result = telefoneRegex.test(telefone);   \n            if(result==false){\n                $(\"input[id*=telefone_cliente]\").css(\"border\", \"1px solid red\");\n                $('#myErrorMsg').fadeIn('fast');\n                $(window).scrollTop(500);\n                $.unblockUI();\n            }\n        }else{\n            $(\"input[id*=telefone_cliente]\").css(\"border\", \"1px solid red\");\n            $(\"input[id*=telefone_cliente]\").attr('placeholder', \"CAMPO OBRIGATÓRIO\");\n            $(window).scrollTop(500);\n            \n        }\n        return result;\n    }\n    \n    function validateLocalizacao(){\n        if(flagMultiLocalizacao === 1 ){\n            if($(\"select[id*=localizacao_imovel]\").val() === ''){\n                $(\"select[id*=localizacao_imovel]\").css(\"border\", \"1px solid red\");\n                $('#myErrorMsg').fadeIn('fast'); \n                $(window).scrollTop(500);\n                $.unblockUI();\n                return false;\n            }else{\n                localizacaoImovel = $(\"select[id*=localizacao_imovel]\").val();\n                return true;\n            } \n        }else{\n            return true;\n        }\n    }\n    \nfunction validadeDataEHoraSolicitada(){\n    \n    var data = $(\"input[id*=data_solicitada]\").val();\n    var hora = $(\"input[id*=hora_solicitada]\").val();\n    var result = true;\n    if(data === '' && hora !== '' ){\n        result=false;\n        $(\"input[id*=data_solicitada]\").css(\"border\", \"1px solid red\");\n        $(\"input[id*=data_solicitada]\").attr('placeholder', \"CAMPO OBRIGATÓRIO\");\n    }else{\n        $(\"input[id*=data_solicitada]\").css(\"border\", \"none\");\n        $(\"input[id*=data_solicitada]\").css(\"border-bottom\", \"1px solid #555\");\n        $(\"input[id*=data_solicitada]\").attr('placeholder', \"\");\n    }\n    if(hora === '' && data !== ''){\n        result=false;\n        $(\"input[id*=hora_solicitada]\").css(\"border\", \"1px solid red\");\n        $(\"input[id*=hora_solicitada]\").attr('placeholder', \"CAMPO OBRIGATÓRIO\");\n    }else{\n        $(\"input[id*=hora_solicitada]\").css(\"border\", \"none\");\n        $(\"input[id*=hora_solicitada]\").css(\"border-bottom\", \"1px solid #555\");\n        $(\"input[id*=hora_solicitada]\").attr('placeholder', \"\");\n    }\n    return result;\n}\n    \n    function pedirAgendamento(idAto){\n        //Validação e tratamento de campos a enviar\n        \n        //Banco\n        var bancoMediaView = \"\";\n        switch(banco){\n            case \"BCP\":\n                bancoMediaView = \"BCP\";\n                break;\n            case \"MTG\":\n                bancoMediaView = \"MPG\";\n                break;\n            case \"BIC\":\n                bancoMediaView = \"BIC\";\n                break;\n            case \"NVB\":\n                bancoMediaView = \"NB\";\n                break;\n            case \"BST\":\n                bancoMediaView = \"BST\";\n                break;\n            case \"ABN\":\n                bancoMediaView = \"Abanca\";\n                break;\n            case \"BNI\":\n                bancoMediaView = \"BNI\";\n                break;\n            case \"GEN\":\n                bancoMediaView = \"BCP\";\n                break;\n            default:\n                bancoMediaView = \"BCP\";\n                break;\n        }\n        \n        //TipoCliente\n        if(tipoCliente === 'particular'){\n            tipoCliente = \"Particular\";\n        }else if(tipoCliente === 'sociedade'){\n            tipoCliente = \"Empresa\";\n        }else{\n            tipoCliente = \"Particular\";\n        }\n        \n        //Data indicativa Agendamento\n        console.log(\"Data solicitada\" + $(\"input[id*=data_solicitada]\").val());\n        \n        console.log(\"Hora solicitada\" + $(\"input[id*=hora_solicitada]\").val());\n        \n        var dataSolicitada = $(\"input[id*=data_solicitada]\").val();\n        var horaSolicitada = $(\"input[id*=hora_solicitada]\").val();\n        if(dataSolicitada.trim() != '' && horaSolicitada.trim() != ''){\n            dataAgendamento = dataSolicitada + \" \" + horaSolicitada;\n            dataAgendamento = dataAgendamento.substring(6,10) + \"-\" + dataAgendamento.substring(3,5) + \"-\" + dataAgendamento.substring(0,2) + \"T\" + dataAgendamento.substring(11,16) + \":00\";\n            \n        }else{\n            dataAgendamento = '';\n        }\n        \n\n        //Observações\n        var observacoes = obsAutomaticas + \"\\n____________________________________________________________\\n\" + obsManuais; \n        \n        \n        if(endereco.trim() === ''){\n            endereco = \"N/A\";\n        }\n        if(localidade.trim() === ''){\n            localidade = \"N/A\";\n        }\n        if(codigoPostal.trim() === ''){\n            codigoPostal = \"N/A\";\n        }\n        \n\n        switch(localizacaoImovel){\n            case \"COM\":\n                localizacaoImovel = \"1\";\n                break;\n            case \"ACO\":\n                localizacaoImovel = \"2\";\n                break;\n            case \"MAD\":\n                localizacaoImovel = \"3\";\n                break;\n            default:\n                localizacaoImovel = \"\";\n                break;\n        }\n        \n        \n        //Pedir Agendamento\n        var username = \"#envVariable.apiMediaViewUsername#\";\n        var password = \"#envVariable.apiMediaViewPassword#\";\n        var urlApi = \"#envVariable.apiMediaViewUrl#\";\n        \n        var xmlhttp = new XMLHttpRequest();\n        \n        xmlhttp.open('POST', urlApi, true);\n        xmlhttp.setRequestHeader('Content-Type', 'text/xml; charset=UTF-8');\n        xmlhttp.onreadystatechange = function () {\n            if (xmlhttp.readyState == 4) {\n                if (xmlhttp.status == 200) {\n                    var xmlResponse = $.parseXML(xmlhttp.responseText);\n                    var result = $(xmlResponse).find(\"EnviarProcessoResult\").text();\n                    console.log(xmlResponse);\n                    console.log(result);\n                    \n                    //Em caso de sucesso atualizo agendamento\n                    //Em caso de insucesso apago o ato\n                    if(result === '-1'){\n                        $(\"input[id*=n_wf_agendamento]\").css(\"border\", \"1px solid red\");\n                        $(\"input[id*=n_wf_agendamento]\").parent().find(\"label\").append('<span class=\"form-error-message\">Número Workflow não definido<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-2'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">O processo não existe na Agenda<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-3'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Banco mal definido<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                        \n                    }else if(result === '-4'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Tipo de Processo não definido<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-5'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Combinação distrito e concelho que está errada<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-6'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Não existe banco relacionado com o distrito/concelho<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-7'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Local mal definido<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-8'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Sem proponentes ou seu conteúdo<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-9'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Sem Data Indicativa definida<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-10'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Erro na delegação<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else if(result === '-99'){\n                        $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Ocorreu um erro no pedido de agendamento<\/span>');\n                        $(window).scrollTop(0);\n                        apagarAto(idAto);\n                    }else{\n                        atualizarAgendamento(idAto,result);\n                    }\n\n                \n                }else if(xmlhttp.status >= 400 && xmlhttp.status <= 499){\n                     $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Ocorreu um erro ao fazer o pedido de agendamento<\/span>');\n                    $(window).scrollTop(0);\n                    apagarAto(idAto);\n\n                }else if(xmlhttp.status >= 500 && xmlhttp.status <= 599){\n                    $(\"form#processo div[class=form-column] input#servico\").after('<span class=\"form-error-message\" style=\"font-size: 20px;font-weight: bold;\">Ocorreu um erro ao fazer o pedido de agendamento<\/span>');\n                    $(window).scrollTop(0);\n                    apagarAto(idAto);\n\n                }\n            }\n        }\n        //                        \n        console.log(\"Data\"+dataAgendamento);\n        var delegacao = \"L\";\n       var sr= `<?xml version=\"1.0\" encoding=\"utf-8\"?>\n                <soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\">\n                  <soap:Header>\n                    <Header xmlns=\"http://tempuri.org/\">\n                      <Username>`+username+`<\/Username>\n                      <Password>`+password+`<\/Password>\n                    <\/Header>\n                  <\/soap:Header>\n                  <soap:Body>\n                    <EnviarProcesso xmlns=\"http://tempuri.org/\">\n                      <processo>\n                        <IdRegisto>`+idAto+`<\/IdRegisto>\n                        <NWF>`+nWfAgendamento+`<\/NWF>\n                        <Banco>`+bancoMediaView+`<\/Banco>\n                        <Delegacao>`+delegacao+`<\/Delegacao>\n                        <Distrito>`+distrito+`<\/Distrito>\n                        <Concelho>`+concelho+`<\/Concelho>\n                        <Localizacao>`+localizacaoImovel+`<\/Localizacao>\n                        <Proponentes>\n                          <Proponente>\n                            <Tipo>`+tipoCliente+`<\/Tipo>\n                            <Nome>`+nomeCliente+`<\/Nome>`\n                            if(nifCliente.trim() !== ''){\n                                sr +=`<NIF>`+nifCliente+`<\/NIF>`\n                            }\n                            \n                            sr+=`<Pais>`+pais+`<\/Pais>\n                            <Morada>\n                            <Endereco>`+endereco+`<\/Endereco>\n                            <Localidade>`+localidade+`<\/Localidade>\n                            <CodigoPostal>`+codigoPostal+`<\/CodigoPostal>\n                            <CodPostalLoc>`+localidade+`<\/CodPostalLoc>\n                            <\/Morada>`;\n                            if(emailCliente.trim() !== ''){\n                                sr += `<Email>`+emailCliente+`<\/Email>`;\n                            }\n                            if(telefoneCliente.trim() !== ''){\n                                sr += `<Telemovel>`+telefoneCliente+`<\/Telemovel>`;\n                            }\n                            \n                            sr+=`<\/Proponente>\n                        <\/Proponentes>`\n                        if(dataAgendamento.trim() !== ''){\n                            sr+=`<DataIndicativa>`+dataAgendamento+`<\/DataIndicativa>`\n                        }\n                        sr+=`<Observacoes>`+observacoes+`<\/Observacoes>\n                      <\/processo>\n                    <\/EnviarProcesso>\n                  <\/soap:Body>\n                <\/soap:Envelope>`;\n            console.log(sr);\n        xmlhttp.send(sr);\n\n        \n    }\n    \n    function criarAto(){\n        contactar = $(\"div[id*=contacto] input:checked\").parent().text().trim();\n        dataSolicitada = $(\"input[id*=data_solicitada]\").val();\n        horaSolicitada = $(\"input[id*=hora_solicitada]\").val();\n        $.ajax({\n            type:\"POST\",\n            url: \"/jw/api/form/atosGeral\",\n            headers:{\n                \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n                \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n                \"Accept\":\"application/json\",\n                \"Content-Type\": \"application/json\"\n            },\n            data: JSON.stringify({\n                            \"id_processo\": \"#form.processos.id#\",\n                            \"id_agendamento\": \"#form.processos.agendamento#\",\n                            \"n_wf_agendamento\": nWfAgendamento,\n                            \"urgencia\": 'SIM',\n                            \"data_solicitada\": dataSolicitada,\n                            \"hora_solicitada\": horaSolicitada,\n                            \"distrito\": distrito,\n                            \"concelho\": concelho,\n                            \"local\": local,\n                            \"observacoes_agendamento\":obsAutomaticas,\n                            \"status\": \"AGN\",\n                            \"contactar\": contactar\n                        }),\n            success: function(response){\n\n                var id = response.id;\n                //Chamar pedido à agenda\n                console.log(id);\n                \n                var passagem = \"#envVariable.passagem#\";\n                //if(passagem === '1'){\n                    pedirAgendamento(id);\n                //}else{\n                    //atualizarAgendamento(id);\n                //}\n                \n                \n\n            }\n        });\n    }\n    \nfunction atualizarAgendamento(idAto, pid){\n    var observacoesAdicionais = $(\"textarea[id*=observacoes_agendamento]\").val();\n    $.ajax({\n        type:\"POST\",\n        url: \"/jw/api/form/agendamento/saveOrUpdate\",\n        headers:{\n            \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n            \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n            \"accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        data: JSON.stringify({\n                        \"id\": \"#form.processos.agendamento#\",\n                        \"flag_agendado\": \"1\",\n                        \"pid_agenda\": pid,\n                        \"observacoes_agendamento\": observacoesAdicionais\n                    }),\n        success: function(data){\n            envioEmailPedidoAgendamento(idAto)\n        }\n    });\n}\nfunction apagarAto(idAto){\n     $.ajax({\n        type:\"DELETE\",\n        url: \"/jw/api/form/atosGeral/\" + idAto,\n        headers:{\n            \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n            \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n            \"Accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        success: function(response){\n            \n        var id = response.code;\n        //console.log(id);\n\n        }\n    });\n\n}\n    \nfunction envioEmailPedidoAgendamento(idAto){\n    \nvar msg = \"Pedido de Agendamento\\n\\n\" + obsAutomaticas + \"\\n\\n\" + obsManuais;\n\nvar subject = \"\";\nsubject += \"Pedido de Agendamento - \" + nWfAgendamento;\n\nvar to = \"#envVariable.emailEnvioAgenda#\";\n\n$.ajax({\n        type:\"POST\",\n        url: \"/jw/api/process/sendEmail/startProcess\",\n        headers:{\n            \"api_id\": \"#envVariable.apiIdAtualizarCampos#\",\n            \"api_key\": \"#envVariable.apiKeyAtualizarCampos#\",\n            \"Accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },data: JSON.stringify({\n            \"email_msg\": msg,\n            \"subject\": subject,\n            \"to\": to\n        }),\n        success: function(response){\n            //Atualização da data de envio de email\n            $.ajax({\n                type:\"POST\",\n                url: \"/jw/api/form/atosGeral/saveOrUpdate\",\n                headers:{\n                    \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n                    \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n                    \"Accept\":\"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },data: JSON.stringify({\n                    \"id\": idAto,\n                    \"data_envio_agenda\": \"#date.dd-MM-yyyy HH:mm#\"\n                }),\n                success: function(response){\n                    location.reload();\n                }\n            });\n        }\n    });\n    \n}\n    \n    \n<\/script>"
                        }
                    }
                ],
                "properties": {"width": "100%"}
            }],
            "properties": {
                "comment": "",
                "id": "informacao_geral",
                "join": "",
                "label": "Informação Geral",
                "loadBinder": {
                    "className": "",
                    "properties": {}
                },
                "permission": {
                    "className": "",
                    "properties": {}
                },
                "permissionReadonly": "",
                "permission_rules": {
                    "093a1241-e305-8c58-bf20-1cefd6a6df94": {
                        "permissionHidden": "",
                        "readonly": "true"
                    },
                    "0e7617d8-1161-e5f1-6cc4-902cedbaaa54": {},
                    "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                    "581aec98-64de-cb6e-5a07-27c7d1e550ba": {},
                    "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                    "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                    "7d10cf1b-4a43-744c-57ae-b2442baee17c": {},
                    "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                    "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                    "9d853985-1ae4-3c97-4cca-9de6c3614741": {},
                    "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                    "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                },
                "readonly": "",
                "readonlyLabel": "",
                "regex": "",
                "reverse": "",
                "storeBinder": {
                    "className": "",
                    "properties": {}
                },
                "visibilityControl": "",
                "visibilityValue": ""
            }
        },
        {
            "className": "org.joget.apps.form.model.Section",
            "elements": [{
                "className": "org.joget.apps.form.model.Column",
                "elements": [{
                    "className": "org.joget.apps.form.lib.CustomHTML",
                    "properties": {
                        "autoPopulate": "",
                        "id": "field8",
                        "label": "",
                        "permission_rules": {
                            "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                            "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                            "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                            "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                            "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                            "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                            "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                            "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                            "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                            "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                            "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                            "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                            "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                            "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                            "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                            "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                        },
                        "value": "<script>\n$(document).ready(function(){\n    \n    $(\"input#novoagendamento\").click(function(){\n        resetEstadoAgendamento();\n    });\n    \n    if($(\"div.form-errors\").length === 1){\n        $(\"div.form-errors\").text(\"EXISTEM ERROS DE AGENDAMENTO\");\n        showReloadModal();\n    }\n    \n    \n});\n\n$(window).load(function(){\n    var idAtos = FormUtil.getValues(\"atos.id\");\n    if(idAtos.length>0){\n        for(i=0; i<idAtos.length; i++){\n            if($(\"div.form-errors\").length !== 1){\n                resetFlagAlteracoes(idAtos[i]);\n            }\n        }\n    }\n    \n    $(\"input[id*=flag_notificacao_alteracoes]\").val('0');\n    resetFlagNotificacaoAlteracoes();\n    \n});\n\nfunction resetEstadoAgendamento(){\n            $.ajax({\n                type:\"POST\",\n                url: \"/jw/api/form/agendamento/saveOrUpdate\",\n                headers:{\n                    \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n                    \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n                    \"accept\":\"application/json\",\n                    \"Content-Type\": \"application/json\"\n                },\n                data: JSON.stringify({\n                                \"id\": \"#form.processos.agendamento#\",\n                                \"flag_agendado\": \"0\"\n                            }),\n                success: function(data){\n                    var idAtos = FormUtil.getValues(\"atos.id\");\n                    if(idAtos.length>0){\n                        //Guardar campos de Ato que são editáveis\n                        var motivoAto = FormUtil.getValues(\"atos.motivo_ato\");\n                        var status = FormUtil.getValues(\"atos.status\");\n                        var dataEnvioAgenda = FormUtil.getValues(\"atos.data_envio_agenda\");\n                        var observacoesAto = FormUtil.getValues(\"atos.observacoes_ato\");\n                        var motivoDesAto = FormUtil.getValues(\"atos.motivo_desmarcacao_ato\");\n                        for(i=0; i<idAtos.length; i++){\n                            updateAto(idAtos[i], status[i], motivoAto[i], motivoDesAto[i],dataEnvioAgenda[i], observacoesAto[i]);\n                            \n                        }\n                    }\n                    location.reload();\n                }\n            });\n}\n\nfunction updateAto(id, status, motivoAto, motivoDesAto, dataEnvioAgenda, observacoesAto){\n    \n    $.ajax({\n        type:\"POST\",\n        url: \"/jw/api/form/atos/saveOrUpdate\",\n        headers:{\n            \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n            \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n            \"Accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        data: JSON.stringify({\n                        \"id\": id,\n                        \"status\": status,\n                        \"motivo_ato\": motivoAto,\n                        \"motivo_desmarcacao_ato\":motivoDesAto,\n                        \"data_envio_agenda\": dataEnvioAgenda,\n                        \"observacoes_ato\": observacoesAto\n                    }),\n        success: function(response){\n            \n        }\n    });\n}\n\nfunction resetFlagAlteracoes(id){\n    $.ajax({\n        type:\"POST\",\n        url: \"/jw/api/form/atosGeral/saveOrUpdate\",\n        headers:{\n            \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n            \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n            \"Accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        data: JSON.stringify({\n            \"id\": id,\n            \"flag_alteracoes_agenda\": \"0\"\n        }),\n        success: function(response){\n        }\n    });\n}\n\nfunction resetFlagNotificacaoAlteracoes(){\n    \n    $.ajax({\n        type:\"POST\",\n        url: \"/jw/api/form/agendamento/saveOrUpdate\",\n        headers:{\n            \"api_id\": \"#envVariable.apiIdComunicacaoMediaView#\",\n            \"api_key\": \"#envVariable.apiKeyComunicacaoMediaView#\",\n            \"accept\":\"application/json\",\n            \"Content-Type\": \"application/json\"\n        },\n        data: JSON.stringify({\n                        \"id\": \"#form.processos.agendamento#\",\n                        \"flag_notificacao_alteracoes\": \"0\"\n                    }),\n        success: function(response){\n \n        }\n    });\n  \n} \n\nfunction showReloadModal(){\n    $(\"#filaTrabalho\").append('<table name=\"modalVerificarAlteracoes\" cellspacing=\"0\" cellpadding=\"0\" border=\"0\" class=\"boxy-wrapper fixed\" style=\"z-index: 1339; visibility: visible; left: 556.5px; top: 66.012px; opacity: 1;\"><tbody><tr><td class=\"top-left\"><\/td><td class=\"top\"><\/td><td class=\"top-right\"><\/td><\/tr><tr><td class=\"left\"><\/td><td class=\"boxy-inner\"><div class=\"title-bar\"><h2>&nbsp;<\/h2><a href=\"#\" class=\"close\"><i class=\"fa fas fa-times\"><\/i><\/a><\/div><div style=\"width: 650px;height: 450px;\"><span class=\"material-symbols-rounded icone_alerta2\">warning<\/span><div class=\"textValidation\" style=\"width: inherit;height: 450px;text-align: center;vertical-align: middle;line-height: 20px;padding: 180px 0px 0px 0px;font-family: \"Ubuntu\", sans-serif !important;font-size: 18px;\">Houveram alterações aos Atos pela Agenda. É necessário atualizar a página.<\/div><div style=\"width: 100%;height: 100px;text-align: center;vertical-align: middle;line-height: 20px;bottom: 0;position: absolute;\"><i class=\"waves-button-input waves-input-wrapper waves-effect btn waves-button waves-float\" style=\"color:rgb(33, 33, 33);background:rgba(0, 0, 0, 0);\"><input id=\"reloadPage\" name=\"reloadPage\" class=\"waves-button-input\" type=\"submit\" value=\"Atualizar página\" style=\"background-color:rgba(0,0,0,0);\"><\/i><\/div><\/div><\/td><td class=\"right\"><\/td><\/tr><tr><td class=\"bottom-left\"><\/td><td class=\"bottom\"><\/td><td class=\"bottom-right\"><\/td><\/tr><\/tbody><\/table>');\n    $(\"#filaTrabalho\").append('<div name=\"blackoutEcra\" class=\"boxy-modal-blackout\" style=\"z-index: 1338; opacity: 0.7; width: 100%; height: 100%; position:fixed; top:0px; left:0px;\"><\/div>');\n    \n    $(\"#reloadPage\").on('click', function() {\n        var idAtos = FormUtil.getValues(\"atos.id\");\n        if(idAtos.length>0){\n            for(i=0; i<idAtos.length; i++){\n                resetFlagAlteracoes(idAtos[i]);\n            }\n        }\n        \n        window.location = \"#request.scheme#://#request.serverName#:#request.serverPort##request.contextPath#/web/userview/workflowPL/UV_PL_Geral/_/filaTrabalho?activityId=#requestParam.activityId#&_mode=assignment\";\n    });\n}\n\n    \n<\/script>\n<input id=\"novoagendamento\" type=\"button\" value=\"PEDIR NOVO AGENDAMENTO\">"
                    }
                }],
                "properties": {"width": "100%"}
            }],
            "properties": {
                "comment": "",
                "id": "mensagemAgendamento",
                "join": "",
                "label": "Agendamento",
                "loadBinder": {
                    "className": "",
                    "properties": {}
                },
                "permission": {
                    "className": "",
                    "properties": {}
                },
                "permissionReadonly": "",
                "permission_rules": {
                    "093a1241-e305-8c58-bf20-1cefd6a6df94": {
                        "permissionHidden": "",
                        "readonly": "true"
                    },
                    "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                    "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                    "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                    "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                    "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                    "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                    "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                },
                "readonly": "",
                "readonlyLabel": "",
                "regex": "",
                "reverse": "",
                "storeBinder": {
                    "className": "",
                    "properties": {}
                },
                "visibilityControl": "",
                "visibilityValue": ""
            }
        },
        {
            "className": "org.joget.apps.form.model.Section",
            "elements": [{
                "className": "org.joget.apps.form.model.Column",
                "elements": [{
                    "className": "org.joget.plugin.enterprise.FormGrid",
                    "properties": {
                        "abortRelatedRunningProcesses": "",
                        "deleteFiles": "",
                        "deleteGridData": "",
                        "deleteMessage": "Delete row?",
                        "deleteSubformData": "",
                        "disabledAdd": "true",
                        "disabledDelete": "true",
                        "enableSorting": "",
                        "errorMessage": "Invalid number of rows",
                        "formDefId": "atos",
                        "height": "85%",
                        "id": "atos",
                        "label": "Atos",
                        "loadBinder": {
                            "className": "org.joget.plugin.enterprise.MultirowFormBinder",
                            "properties": {
                                "foreignKey": "id_agendamento",
                                "formDefId": "atos"
                            }
                        },
                        "options": [
                            {
                                "format": "opcoesDisplayGrid",
                                "formatType": "options",
                                "label": "Status",
                                "value": "status",
                                "width": ""
                            },
                            {
                                "format": "",
                                "formatType": "text",
                                "label": "Data Outorga",
                                "value": "dataOutorga",
                                "width": ""
                            },
                            {
                                "format": "",
                                "formatType": "text",
                                "label": "Hora Outorga",
                                "value": "horaOutorga",
                                "width": ""
                            },
                            {
                                "format": "",
                                "formatType": "text",
                                "label": "Local",
                                "value": "localOutorga",
                                "width": ""
                            },
                            {
                                "format": "opcoesDisplayGrid",
                                "formatType": "options",
                                "label": "Entidade",
                                "value": "entidade",
                                "width": ""
                            },
                            {
                                "format": "",
                                "formatType": "text",
                                "label": "Procurador",
                                "value": "procurador",
                                "width": ""
                            }
                        ],
                        "pageSize": "20",
                        "permissionHidden": "",
                        "permission_rules": {
                            "093a1241-e305-8c58-bf20-1cefd6a6df94": {},
                            "1fa5eef4-6607-58b1-6a12-e2ed8ae717c9": {},
                            "4ca43afb-7ca5-9595-7d5e-480f9e1269aa": {},
                            "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                            "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                            "5d138c56-1736-dff2-b7d8-c8667858776c": {
                                "permissionHidden": "",
                                "readonly": "true"
                            },
                            "6fb83d36-30a3-de4b-f6ee-475a1d3c4ee1": {},
                            "73d59c6e-5d43-9985-020a-1564a2bd69fd": {},
                            "7661310a-7dc3-e855-1d82-7f7bb70319c7": {},
                            "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                            "8d26fcff-b200-5ba6-a36b-6bf75f33839e": {},
                            "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                            "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {
                                "permissionHidden": "",
                                "readonly": "true"
                            },
                            "d199304d-533b-4262-2d03-af9fd4ca82af": {},
                            "d71cd104-0c18-2072-f92d-82b847d18ab5": {},
                            "f05453aa-e857-3dfd-90e1-d657d9b594a5": {}
                        },
                        "readonly": "",
                        "readonlyLabel": "",
                        "showRowNumber": "",
                        "storeBinder": {
                            "className": "org.joget.plugin.enterprise.MultirowFormBinder",
                            "properties": {
                                "foreignKey": "id_agendamento",
                                "formDefId": "atos"
                            }
                        },
                        "submit-label-normal": "",
                        "submit-label-readonly": "",
                        "uniqueKey": "",
                        "validateMaxRow": "",
                        "validateMinRow": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "width": "85%"
                    }
                }],
                "properties": {"width": "100%"}
            }],
            "properties": {
                "comment": "",
                "id": "section4",
                "join": "",
                "label": "Atos",
                "loadBinder": {
                    "className": "",
                    "properties": {}
                },
                "permission": {
                    "className": "",
                    "properties": {}
                },
                "permissionReadonly": "",
                "permission_rules": {
                    "093a1241-e305-8c58-bf20-1cefd6a6df94": {
                        "permissionHidden": "",
                        "readonly": ""
                    },
                    "570533e0-cbb7-f32b-9695-a8e9d2370a33": {},
                    "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09": {},
                    "5d138c56-1736-dff2-b7d8-c8667858776c": {},
                    "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8": {},
                    "8f7b8a9d-4999-7784-7a33-918d09fbdc0d": {},
                    "c1ad5abb-3437-3755-3fac-bbbe4c8ed572": {},
                    "d199304d-533b-4262-2d03-af9fd4ca82af": {}
                },
                "readonly": "",
                "readonlyLabel": "",
                "regex": "",
                "reverse": "",
                "storeBinder": {
                    "className": "",
                    "properties": {}
                },
                "visibilityControl": "",
                "visibilityValue": ""
            }
        }
    ],
    "properties": {
        "description": "",
        "id": "agendamento",
        "loadBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "name": "CH - Agendamento",
        "noPermissionMessage": "",
        "permission": {
            "className": "",
            "properties": {}
        },
        "permission_rules": [
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\nString mode = \"#requestParam._mode#\";\nif(mode.equals(\"edit\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "d199304d-533b-4262-2d03-af9fd4ca82af",
                "permission_name": "Consulta"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(fase.equals(\"FLT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "8f7b8a9d-4999-7784-7a33-918d09fbdc0d",
                "permission_name": "Filtro"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(fase.equals(\"PRD\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "5d138c56-1736-dff2-b7d8-c8667858776c",
                "permission_name": "Produção"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(fase.equals(\"VAL\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "c1ad5abb-3437-3755-3fac-bbbe4c8ed572",
                "permission_name": "Validação"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"BIC\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "570533e0-cbb7-f32b-9695-a8e9d2370a33",
                "permission_name": "Contratação BIC"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"ABN\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "0e7617d8-1161-e5f1-6cc4-902cedbaaa54",
                "permission_name": "Contratação ABN"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"BCP\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "9d853985-1ae4-3c97-4cca-9de6c3614741",
                "permission_name": "Contratação BCP"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"BST\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "581aec98-64de-cb6e-5a07-27c7d1e550ba",
                "permission_name": "Contratação BST"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"NVB\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "7d10cf1b-4a43-744c-57ae-b2442baee17c",
                "permission_name": "Contratação NVB"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"MTG\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "5b2fae9f-2c09-fec1-c2ae-b82fc5ab6d09",
                "permission_name": "Contratação MTG"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\n\nString banco = \"#form.detalhe_processo.nome_banco[{form.processos.detalhe_processo}]#\";\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(banco.equals(\"BNI\") && fase.equals(\"CNT\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "7dcda20a-eb2d-d47b-aa3c-1decb7a775a8",
                "permission_name": "Contratação BNI"
            },
            {
                "permission": {
                    "className": "org.joget.apps.userview.lib.BeanShellPermission",
                    "properties": {"script": "import org.joget.commons.util.LogUtil;\n\nString fase = \"#form.detalhe_processo.fase_processo[{form.processos.detalhe_processo}]#\";\nif(fase.equals(\"AO\")){\n    return true;\n}else{\n    return false;\n}"}
                },
                "permission_key": "093a1241-e305-8c58-bf20-1cefd6a6df94",
                "permission_name": "Acompanhamento de Outorgas"
            }
        ],
        "postProcessor": {
            "className": "",
            "properties": {}
        },
        "postProcessorRunOn": "create",
        "storeBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "tableName": "agendamento"
    }
}